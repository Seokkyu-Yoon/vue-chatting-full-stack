(function(e){function t(t){for(var r,i,a=t[0],u=t[1],c=t[2],l=0,f=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);m&&m(t);while(f.length)f.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],r=!0,a=1;a<o.length;a++){var u=o[a];0!==n[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=o[0]))}return e}var r={},n={app:0},s=[];function i(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=r,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var m=u;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},1294:function(e,t,o){"use strict";o("4af0")},1803:function(e,t,o){"use strict";o("c0c8")},"267d":function(e,t,o){"use strict";o("fa4b")},"2a69":function(e,t,o){},"4af0":function(e,t,o){},5614:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var r=o("2b0e"),n=o("2b27"),s=o.n(n),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},a=[];function u(){this.serverIp="http://192.168.1.77:".concat(Object({NODE_ENV:"production",BASE_URL:"/"}).PORT||"3000"),this.joiningRoomKey=null,this.userName="",this.userMap={},this.roomMap={},this.messages=[],console.log(this.serverIp)}var c=new u,m=c,l={mounted:function(){var e=this;this.$socket.on("connect",(function(){""!==m.userName&&(e.$request("req:user:login",{userName:m.userName,roomKey:m.joiningRoomKey}),e.$request("req:room:list"))})),this.$socket.on("res:room:create",(function(e){m.joiningRoomKey=e})),this.$socket.on("event:user:list",(function(e){m.userMap=e,console.log("event:user:list"),console.log(e)})),this.$socket.on("res:user:list",(function(e){m.userMap=e,console.log("res:user:list"),console.log(e)})),this.$socket.on("event:room:list",(function(e){m.roomMap=e})),this.$socket.on("res:room:list",(function(e){m.roomMap=e})),this.$socket.on("event:room:messages",(function(e){m.messages=e})),this.$socket.on("res:room:messages",(function(e){m.messages=e}))}},f=l,d=(o("267d"),o("2877")),p=Object(d["a"])(f,i,a,!1,null,"463b68f8",null),v=p.exports,h=o("8c4f"),y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover"}},[o("ComponentLogin")],1)},g=[],_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover-enter"}},[o("h1",[e._v("닉네임")]),o("div",{attrs:{id:"form-holder"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.store.userName,expression:"store.userName"}],attrs:{type:"text",placeholder:"닉네임을 입력해주세요"},domProps:{value:e.store.userName},on:{keydown:[e.setUserName,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}],input:function(t){t.target.composing||e.$set(e.store,"userName",t.target.value)}}}),o("button",{on:{click:e.login}},[e._v("접속")])])])},k=[],b=(o("ac1f"),o("5319"),{name:"Login",beforeCreate:function(){null!==this.$cookies.get("token")&&this.$router.replace("/Chat"),this.$cookies.remove("token")},data:function(){return{store:m}},methods:{setUserName:function(e){m.userName=String(e.target.value).replace(" ","")},login:function(){""!==m.userName?(this.$request("req:user:login",{userName:m.userName}),this.$router.replace("/Chat")):alert("닉네임을 입력해주세요")}}}),N=b,j=(o("1294"),Object(d["a"])(N,_,k,!1,null,"95999f60",null)),w=j.exports,$={name:"Home",components:{ComponentLogin:w}},x=$,K=(o("1803"),Object(d["a"])(x,y,g,!1,null,"2be177b0",null)),R=K.exports,C=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover"}},[o("ComponentRooms",{attrs:{rooms:e.rooms}}),null!==e.store.joiningRoomKey?o("ComponentChat",{attrs:{roomKey:e.store.joiningRoomKey,messages:e.store.messages}}):e._e(),o("ComponentUsers",{attrs:{users:e.users}})],1)},O=[],q=(o("caad"),o("d81d"),o("13d5"),o("b64b"),o("2532"),o("5530")),T=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover-rooms"}},[o("h1",[e._v("방 목록")]),o("div",{attrs:{id:"holder-rooms"}},e._l(e.rooms,(function(t){return o("div",{key:"room-"+t.roomKey,class:e.store.joiningRoomKey===t.roomKey?"room selected":"room",on:{click:function(o){return e.setCurrRoom(t)}}},[o("div",{staticClass:"room-key"},[e._v(e._s(t.roomKey))]),o("div",{staticClass:"room-name"},[e._v(e._s(t.roomName))]),o("div",[e._v(e._s(t.sockets.length))])])})),0),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newRoomName,expression:"newRoomName"}],attrs:{type:"text",placeholder:"새로운 방 이름을 입력해주세요"},domProps:{value:e.newRoomName},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.makeRoom(t)},input:function(t){t.target.composing||(e.newRoomName=t.target.value)}}}),o("button",{on:{click:e.makeRoom}},[e._v("+ 방 추가")])])},M=[],E={name:"Rooms",data:function(){return{store:m,newRoomName:""}},props:["rooms"],methods:{leaveRoom:function(){null!==m.joiningRoomKey&&this.$request("req:room:leave",{userName:m.userName,roomKey:m.joiningRoomKey})},makeRoom:function(){this.newRoomName?(this.$request("req:room:create",{userName:m.userName,roomName:this.newRoomName}),this.newRoomName=""):alert("방 이름을 입력해주세요")},setCurrRoom:function(e){var t=e.roomKey,o=m.joiningRoomKey;null!==o&&this.$request("req:room:leave",{userName:m.userName,roomKey:o}),t!==o?(this.$request("req:room:join",{userName:m.userName,roomKey:t}),m.joiningRoomKey=t,this.$request("req:room:messages",{roomKey:t})):m.joiningRoomKey=null}},beforeDestroy:function(){null!==m.joiningRoomKey&&(this.$request("req:room:leave",{userName:m.userName,roomKey:m.joiningRoomKey}),m.joiningRoomKey=null)}},P=E,S=(o("f402"),Object(d["a"])(P,T,M,!1,null,"61629eb2",null)),H=S.exports,I=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover-chat"}},[o("h1",[e._v("채팅")]),o("div",{attrs:{id:"chat-board"}},e._l(e.messages,(function(t,r){return o("div",{key:"message-"+r},["message"===t.type?o("div",{staticClass:"message"},[o("div",{staticClass:"message-header"},[o("div",{staticClass:"message-header-name"},[e._v(e._s(t.userName))]),o("div",{staticClass:"message-header-time"},[e._v(e._s(t.time))])]),o("div",{staticClass:"text"},[e._v(e._s(t.text))])]):"time"===t.type?o("div",[o("div",[e._v(" "+e._s(t.text)+" ")])]):o("div",{staticClass:"access-record"},[e._v(" "+e._s(t.userName)+"님이 "+e._s("join"===t.type?"입장":"퇴장")+"하였습니다. ")])])})),0),o("div",{attrs:{id:"chat-form"}},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newText,expression:"newText"}],attrs:{type:"text"},domProps:{value:e.newText},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:function(t){t.preventDefault(),e.send()}(t)},input:function(t){t.target.composing||(e.newText=t.target.value)}}}),e._v(" "),o("button",{on:{click:e.send}},[e._v("전송")])])])},U=[],B=(o("498a"),{name:"Chat",props:["roomKey","messages"],data:function(){return{newText:"",scrollToBottom:!0}},mounted:function(){var e=document.querySelector("#chat-board");e.scrollTop=e.scrollHeight-e.clientHeight},beforeUpdate:function(){var e=document.querySelector("#chat-board");this.scrollToBottom=e.scrollTop===e.scrollHeight-e.clientHeight},updated:function(){if(this.scrollToBottom){var e=document.querySelector("#chat-board");e.scrollTop=e.scrollHeight-e.clientHeight}},methods:{send:function(){""!==this.newText.trim()&&(this.$request("req:room:write",{token:this.$cookies.get("token"),roomKey:this.roomKey,text:this.newText.trim()}),this.newText="")}}}),L=B,D=(o("6e25"),Object(d["a"])(L,I,U,!1,null,"505ee278",null)),J=D.exports,A=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"cover-users"}},[o("h1",[e._v("사용자 목록")]),o("div",{attrs:{id:"holder-users"}},e._l(e.users,(function(t){return o("div",{key:"user-"+t.socketId,staticClass:"user"},[o("div",{staticClass:"user-key"},[e._v(e._s(t.socketId))]),o("div",{staticClass:"user-name"},[e._v(e._s(t.userName))])])})),0)])},V=[],z={name:"Users",props:["users"],methods:{makeuser:function(){this.newuserName||alert("방 이름을 입력해주세요")}}},F=z,G=(o("7f7a"),Object(d["a"])(F,A,V,!1,null,"675ff6e7",null)),Q=G.exports,W={name:"Chat",components:{ComponentRooms:H,ComponentChat:J,ComponentUsers:Q},data:function(){return{store:m,userMap:{}}},beforeCreate:function(){""!==m.userName?this.$request("req:room:list"):this.$router.replace("/")},computed:{users:function(){var e=Object.keys(m.userMap);return null===m.joiningRoomKey?e.map((function(e){return{socketId:e,userName:m.userMap[e].userName}})):e.reduce((function(e,t){var o=m.userMap[t];return m.roomMap[m.joiningRoomKey].sockets.includes(t)?(e.push({socketId:t,userName:o.userName}),e):e}),[])},rooms:function(){return Object.keys(m.roomMap).map((function(e){return Object(q["a"])({roomKey:e},m.roomMap[e])}))}}},X=W,Y=(o("dfa1"),Object(d["a"])(X,C,O,!1,null,"7b399a6c",null)),Z=Y.exports;r["a"].use(h["a"]);var ee=[{path:"/",name:"Home",component:R},{path:"/chat",name:"Chat",component:Z}],te=new h["a"]({mode:"history",base:"/",routes:ee}),oe=te,re=o("8e27"),ne=o.n(re),se=ne()(m.serverIp,{transports:["websocket"]}),ie={install:function(e){function t(e,t){se.emit(e,t)}e.mixin({}),Object.assign(e.prototype,{$socket:se,$request:t})}},ae=ie;r["a"].config.productionTip=!1,r["a"].use(s.a),r["a"].use(ae),r["a"].$cookies.config("7d"),new r["a"]({router:oe,render:function(e){return e(v)}}).$mount("#app")},"6e25":function(e,t,o){"use strict";o("886b")},"7f7a":function(e,t,o){"use strict";o("2a69")},"886b":function(e,t,o){},c0c8:function(e,t,o){},dfa1:function(e,t,o){"use strict";o("5614")},f1e5:function(e,t,o){},f402:function(e,t,o){"use strict";o("f1e5")},fa4b:function(e,t,o){}});
//# sourceMappingURL=app.6df380e6.js.map